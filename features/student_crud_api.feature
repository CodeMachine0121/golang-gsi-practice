Feature: Student CRUD API
  作為學校系統管理員，我想要有一個 API 來管理學生資訊
  以便能夠建立、查看、更新和刪除學生記錄。

  Scenario: 成功新增學生
    Given 系統已初始化
    When 我提交新學生資訊，包含姓名「王小明」、學號「2024001」、電子郵件「wang@school.edu」和班級「一年一班」
    Then 系統應該成功建立學生記錄
    And 返回的學生 ID 應該不為空
    And 返回的學生資訊應該與提交的資訊相符

  Scenario: 查詢單一學生
    Given 系統中已存在學號為「2024001」、姓名為「王小明」的學生記錄
    When 我使用學號「2024001」查詢學生
    Then 系統應該返回該學生的完整資訊
    And 返回的資訊應該包含姓名、學號、電子郵件和班級

  Scenario: 查詢所有學生
    Given 系統中已存在 5 筆學生記錄
    When 我請求查詢所有學生
    Then 系統應該返回所有 5 筆學生記錄
    And 每筆記錄都應該包含學生的完整資訊

  Scenario: 成功更新學生資訊
    Given 系統中已存在學號為「2024001」的學生記錄
    When 我將該學生的電子郵件更新為「wang.new@school.edu」
    Then 系統應該成功更新學生記錄
    And 查詢該學生時應該返回新的電子郵件地址

  Scenario: 成功刪除學生
    Given 系統中已存在學號為「2024001」的學生記錄
    When 我請求刪除該學生記錄
    Then 系統應該成功刪除該學生
    And 再次查詢該學號時應該返回「學生不存在」的錯誤

  Scenario: 新增時缺少必填欄位
    Given 系統已初始化
    When 我提交不完整的學生資訊，缺少姓名欄位
    Then 系統應該拒絕並返回錯誤 「姓名為必填欄位」
    And 學生記錄不應該被建立

  Scenario: 學號必須唯一
    Given 系統中已存在學號為「2024001」的學生記錄
    When 我嘗試新增另一個學號相同「2024001」的學生
    Then 系統應該拒絕並返回錯誤 「學號已存在」
    And 新的學生記錄不應該被建立

  Scenario: 電子郵件格式驗證
    Given 系統已初始化
    When 我提交學生資訊，電子郵件為無效格式「invalid-email」
    Then 系統應該拒絕並返回錯誤 「無效的電子郵件格式」
    And 學生記錄不應該被建立

  Scenario: 查詢不存在的學生
    Given 系統已初始化
    When 我使用不存在的學號「9999999」查詢學生
    Then 系統應該返回錯誤 「學生不存在」
    And HTTP 狀態碼應該是 404

  Scenario: 更新不存在的學生
    Given 系統已初始化
    When 我嘗試更新不存在的學號「9999999」的學生資訊
    Then 系統應該返回錯誤 「學生不存在」
    And 不應該建立新的學生記錄

  Scenario: 刪除不存在的學生
    Given 系統已初始化
    When 我嘗試刪除不存在的學號「9999999」的學生
    Then 系統應該返回錯誤 「學生不存在」
    And HTTP 狀態碼應該是 404

  Scenario: 部分更新學生資訊
    Given 系統中已存在學號為「2024001」的學生記錄，班級為「一年一班」
    When 我只更新該學生的班級為「一年二班」，不更新其他欄位
    Then 系統應該成功更新班級欄位
    And 其他欄位應該保持不變
    And 學號應該仍然是「2024001」

  Scenario: 驗證年級範圍
    Given 系統已初始化
    When 我提交學生資訊，年級為無效值「10」（超出範圍）
    Then 系統應該拒絕並返回錯誤 「年級必須在 1-6 之間」
    And 學生記錄不應該被建立
